(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["PinBetterSaveCommon"],{"+c4W":function(e,t,n){var a=n("711d"),o=n("4/ic"),r=n("9ggG"),i=n("9Nap");e.exports=function(e){return r(e)?a(i(e)):o(e)}},"0zyx":function(e,t,n){n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var a=n("mVx/"),o=n.n(a);const r=({pathname:e})=>/^\/pin\/[\w-]+\/?$/.test(e),i=e=>{const t=o()(e,e=>!r(e));return t&&(({pathname:e})=>/^\/search\/pins\//.test(e))(t)?(({pathname:e,search:t})=>{const n=/^\/search\/pins\/(\?.*)$/.exec(e),a=(t||n&&n[1]||"").substr(1).split("&").map(e=>e.split("=")).find(e=>"q"===e[0]);return a?decodeURIComponent(a[1]):""})(t):""}},"1vym":function(e,t,n){},"4/ic":function(e,t,n){var a=n("ZWtO");e.exports=function(e){return function(t){return a(t,e)}}},"5uyJ":function(e,t,n){n.d(t,"a",(function(){return a}));const a={V_HLSV4:"V_HLSV4",V_720P:"V_720P"}},"711d":function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},"7vSn":function(e,t,n){},"82UD":function(e,t,n){var a=n("q1tI"),o=n.n(a),r=n("/MKj"),i=n("ajUs"),s=n("ou9u"),c=n("gYog"),l=n("hFNL"),d=n("3gA6"),u=n("yKES"),h=n("5uyJ"),p=n("n6mq");const m={overlay:{__style:{backgroundColor:"#000"}}};function g(e){const{pin:{id:t,images:n,title:a,videos:r,video_status_message:i}}=e,s=i||{},c=n&&n["236x"],l=r&&r.video_list[h.a.V_HLSV4],{duration:g}=l||{};return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.f,null,o.a.createElement(d.b,{to:`/pin/${t}`},o.a.createElement(p.d,{overflow:"hidden",position:"relative",rounding:2},c&&o.a.createElement(p.q,{alt:a||"",color:"lightGray",naturalHeight:c.height,naturalWidth:c.width,src:c.url}),!!g&&o.a.createElement(p.d,{padding:2,position:"absolute",bottom:!0,left:!0,display:"flex"},o.a.createElement(u.a,{duration:g})),o.a.createElement(p.d,{position:"absolute",top:!0,bottom:!0,left:!0,right:!0,opacity:.4,dangerouslySetInlineStyle:m.overlay}),o.a.createElement(p.d,{position:"absolute",top:!0,left:!0,padding:5,width:"100%"},o.a.createElement(p.n,{color:"white",overflow:"normal",size:"sm"},s.title),o.a.createElement(p.d,{marginTop:4},o.a.createElement(p.P,{color:"white",size:"md",overflow:"normal"},s.subtitle)))),o.a.createElement(p.d,{display:"flex",alignItems:"start",justifyContent:"between",marginTop:1,paddingX:1},o.a.createElement(p.d,{flex:"grow"},a&&o.a.createElement(p.d,{paddingY:1},o.a.createElement(p.P,{inline:!0,size:"md",weight:"bold"},a)))))))}var f=n("Y8Sn"),b=n("vpxy"),v=n("0nTG");t.a=Object(r.connect)((function({pins:e},{pin:t,pinId:n}){return{reduxPin:e[n]||t}}),()=>({}))((function({reduxPin:e,trackingParameters:t,...n}){const d=Object(r.useSelector)(({location:e})=>e),u=Object(i.a)(e,d),h=Object(s.a)(e),p=!!(h&&h.url&&h.height&&h.width)||void 0,m=h&&e.videos?e.videos.id:void 0,[y,S]=Object(a.useState)(!1),_=Object(a.useCallback)(()=>S(!0),[]),E=Object(a.useCallback)(()=>S(!1),[]),{componentType:w,contextLogData:I,impressionAuxFields:C,slotIndex:B,viewData:O,viewParameter:x,viewType:R}=t;return o.a.createElement(c.a,{componentType:w,contextLogData:{..."undefined"!=typeof window?{pwa_type:Object(l.b)(window)}:{},...I,...Object(v.a)(e,I)},impressionAuxFields:{...C||{},isNativeVideoAndWatchable:p,videoIdStr:m,clientTrackingParams:u||`${e.tracking_params||""}-0`,imageURL:e.images&&e.images["236x"].url,richTypes:Object(v.c)(e)},impressionType:"Pin",isPaused:!y,loggingId:e.id,slotIndex:B,viewData:O,viewParameter:x,viewType:R},Object(f.e)(e)?o.a.createElement(g,{pin:e}):o.a.createElement(b.a,Object.assign({},n,{debugImpressionState:y?"started":"paused",onError:E,onLoad:_,pin:e,trackingParameters:{componentType:w,contextLogData:I,slotIndex:B,viewParameter:x,viewType:R}})))}))},CMye:function(e,t,n){var a=n("GoyQ");e.exports=function(e){return e==e&&!a(e)}},EuRG:function(e,t,n){function a(e,t){return{type:"SEARCH_PIN_CLOSEUP_VIEWED",payload:{pinId:e,query:t}}}function o(e){return{type:"SEARCH_QUERY_STARTED",payload:{query:e}}}function r(e){return{type:"SEARCH_QUERY_INVALIDATED",payload:{query:e}}}n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return r}))},Ev07:function(e,t,n){var a=n("1inl"),o=n("UTsl"),r=n("Ye/N"),i=n("mBfy");const s={checkFbTimelinePermission:function(e){o.default.ensureInit((function(t){t.api("/me/permissions",t=>{const n=t.data;let a=!1;if(n){a=!!n.find(e=>"publish_actions"===e.permission&&"granted"===e.status)}a?e.success&&e.success():e.error&&e.error()})}),i.default)},fbConnectedAccountMatchesLoggedInAccount:function(e,t){if(!t)return!0;const n=e.getAuthResponse();return!n||t===n.userID},maybeRequestFbTimelinePermission:function(e,t){o.default.ensureInit(n=>{if(!s.fbConnectedAccountMatchesLoggedInAccount(n,t))return a.a.showError(r.a._("Oops! Your account is linked to a different Facebook account than the one you're logged into now.")),e.error&&e.error(),void(e.complete&&e.complete());s.checkFbTimelinePermission({success(){e.success&&e.success(),e.complete&&e.complete()},error(){s.fbLogin(e)}})},i.default)},fbLogin:function(e){o.default.ensureInit(t=>{t.login(t=>{t.authResponse?s.checkFbTimelinePermission(e):e.error&&e.error(),e.complete&&e.complete()},{scope:"publish_actions"})},i.default)},getLocaleString:function(e){let t=e;switch(t=t.replace(/-/g,"_")){case"de":t="de_DE";break;case"fr":t="fr_FR";break;case"it":t="it_IT";break;case"ja":t="ja_JP";break;case"nl":t="nl_NL";break;case"tr":t="tr_TR";break;case"en_AU":t="en_US"}return t.startsWith("es")&&(t="es_LA"),t.startsWith("ar")&&(t="ar_AR"),t}};t.a=s},GDhZ:function(e,t,n){var a=n("wF/u"),o=n("mwIZ"),r=n("hgQt"),i=n("9ggG"),s=n("CMye"),c=n("IOzZ"),l=n("9Nap"),d=1,u=2;e.exports=function(e,t){return i(e)&&s(t)?c(l(e),t):function(n){var i=o(n,e);return void 0===i&&i===t?r(n,e):a(t,i,d|u)}}},"H/Lk":function(e,t,n){n.d(t,"a",(function(){return a}));const a=(e,t,n)=>({type:"MOST_RECENT_BOARD",payload:{id:e,name:t,url:n}})},IOzZ:function(e,t){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},JELi:function(e,t,n){var a=n("KwMD"),o=n("ut/Y"),r=n("Sxd8"),i=Math.max,s=Math.min;e.exports=function(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var l=c-1;return void 0!==n&&(l=r(n),l=n<0?i(c+l,0):s(l,c-1)),a(e,o(t,3),l,!0)}},O7RO:function(e,t,n){var a=n("CMye"),o=n("7GkX");e.exports=function(e){for(var t=o(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,a(i)]}return t}},P6kd:function(e,t,n){var a=n("q1tI"),o=n.n(a),r=n("Ye/N"),i=n("oRao"),s=n("eOdZ"),c=n("vxan"),l=n("vvax"),d=n("n6mq");function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=5,p=27,m=38,g=40,f=13;t.a=Object(c.a)(class extends o.a.Component{constructor(...e){super(...e),u(this,"state",{recommendations:[],selectedIndex:0,resourceLoaded:!1}),u(this,"onDismiss",()=>{}),u(this,"mounted",!1),u(this,"addHashtag",e=>{this.props.addHashtag(e),this.setState({recommendations:[]})}),u(this,"handleKeyDown",e=>{e.keyCode===m?this.handlePrevHashtag(e):e.keyCode===g?this.handleNextHashtag(e):e.keyCode===p?this.handleClose(e):e.keyCode===f&&this.handleSubmit(e)}),u(this,"handlePrevHashtag",e=>{e.preventDefault(),this.state.selectedIndex>0&&this.setState(e=>({selectedIndex:e.selectedIndex-1}))}),u(this,"handleNextHashtag",e=>{e.preventDefault(),this.state.selectedIndex<this.state.recommendations.length-1&&this.setState(e=>({selectedIndex:e.selectedIndex+1}))}),u(this,"handleClose",e=>{e.preventDefault(),this.setState({recommendations:[]})}),u(this,"handleSubmit",e=>{e.preventDefault(),this.addHashtag(this.state.recommendations[this.state.selectedIndex].query)}),u(this,"callResource",e=>{const{makeCancelablePromise:t}=this.props;t(s.a.create("HashtagTypeaheadResource",{query:e,showPinCount:!0}).callGet(),"typeahead").then(e=>{if(!this.mounted)return;const t=e.resource_response.data;this.setState({recommendations:t.slice(0,h),resourceLoaded:!0})}).catch(({isCanceled:e})=>{e||this.setState({resourceLoaded:!1})})})}componentDidMount(){this.mounted=!0,this.callResource(this.props.query),window.addEventListener("keydown",this.handleKeyDown)}UNSAFE_componentWillReceiveProps(e){e.query!==this.props.query&&""!==e.query&&this.callResource(e.query)}componentWillUnmount(){window.removeEventListener("keydown",this.handleKeyDown),this.mounted=!1}render(){const{recommendations:e,resourceLoaded:t,selectedIndex:n}=this.state,{anchor:a,idealDirection:s}=this.props,c=e.filter(e=>e.query),u=s||"down",h="flyout_"+c.length;return t&&c.length>0?o.a.createElement("div",{className:"HashtagFlyout"},o.a.createElement(d.l,{key:h,anchor:a,idealDirection:u,onDismiss:this.onDismiss,size:"sm"},o.a.createElement("div",{className:"HashtagRecommendations"},c.length>0?c.map((e,t)=>o.a.createElement("div",{className:"HashtagItem",key:e.query},o.a.createElement(d.O,{fullWidth:!1,onTap:t=>this.addHashtag(e.query)},o.a.createElement(d.d,{display:"flex",justifyContent:"between",alignItems:"center",color:t===n?"lightGray":"transparent",padding:1},o.a.createElement(d.d,{flex:"grow"},o.a.createElement(d.P,{inline:!0,size:"md",weight:"bold"},e.query)),o.a.createElement(d.d,{flex:"none"},o.a.createElement(d.P,{inline:!0,size:"sm"},Object(l.b)(r.a.ngettext("{{ count }} pin","{{ count }} pins",Number(e.pin_count),"label for n pins in hashtag flyout","label for n pins in hashtag flyout"),{count:o.a.createElement(i.a,{value:Number(e.pin_count),key:"pinCount"})}))))))):null))):null}})},QoKk:function(e,t,n){var a=n("q1tI"),o=n.n(a),r=(n("w/op"),n("Ye/N")),i=n("rYoy"),s=n("n6mq");const c=["es-AR","es-BZ","es-BO","pt-BR","en-CA","es-CL","zh-CN","es-CO","es-CR","es-DO","es-EC","es-SV","es-GT","es-HN","zh-HK","he","en-JM","ja","en-KE","zh-MO","es-MX","es-NI","es-PA","es-PE","en-PH","es-PR","en-ZA","ko","zh-TW","en-US","es-VE"];var l=n("pLLR");const d=Object(a.lazy)(()=>n.e(21).then(n.t.bind(null,"sQeT",7))),u=(e,t)=>e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear();var h=Object(l.f)((function({onSelectedDate:e,selectedDates:t,requestContext:n}){return o.a.createElement(i.a,null,o.a.createElement(d,{calendarType:c.includes(n.locale)?"US":"ISO 8601",locale:n.locale||"",className:"DatePicker",enableHistoryView:!1,onClickDay:n=>{1===t.length&&t[0]<n?e([t[0],n]):e([n])},minDetail:"month",nextLabel:o.a.createElement(s.o,{accessibilityLabel:r.a._("Next month","BoardForm.BoardFormExperimentalDatePicker","accessibility label on arrow to go to next calendar month"),icon:"arrow-forward"}),next2Label:null,prevLabel:o.a.createElement(s.o,{icon:"arrow-back",accessibilityLabel:r.a._("Previous month","BoardForm.BoardFormExperimentalDatePicker","accessibility label on arrow to go to previous calendar month")}),prev2Label:null,tileClassName:({date:e})=>{const n=[],[a,o]=t;return a&&u(e,a)?(n.push("start"),o&&n.push("rangeStart")):o&&u(e,o)?n.push("rangeEnd"):2===t.length&&e>=a&&e<=o&&n.push("inRange"),n},value:t.length?t:new Date,view:"month"}))})),p=n("TiQD");const m=356;t.a=Object(l.f)((function({dates:e,onChange:t,onToggleFlyout:n=(()=>{}),requestContext:i}){const c=Object(a.useRef)(null),[l,d]=Object(a.useState)(!1),[u,g]=Object(a.useState)(e||[]),[f,b]=u||[];let v=f&&f.toLocaleDateString(i.locale)||"";if(b){v+=" - "+u[1].toLocaleDateString(i.locale)}const y=()=>{n(),d(!l)};return o.a.createElement(a.Fragment,null,o.a.createElement("div",{style:{position:"relative"},ref:c},o.a.createElement(s.R,{autoComplete:"off",id:"boardEditDate",onChange:()=>{},onFocus:y,onKeyDown:({event:e})=>{"Backspace"===e.key&&(g([]),t([]))},placeholder:r.a._("Select start and end","BoardForm.BoardFormDateField","placeholder for input field to enter board end and start dates"),size:"lg",value:v}),o.a.createElement(s.d,{dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},position:"absolute",top:!0,right:!0,padding:4},o.a.createElement(s.o,{color:"darkGray",icon:"calendar",accessibilityLabel:r.a._("Select date","BoardForm.BoardFormDateField","accessibility label on calendar icon")}))),l&&o.a.createElement(s.s,null,o.a.createElement(s.d,{position:"absolute",top:!0,dangerouslySetInlineStyle:{__style:{zIndex:p.a}}},o.a.createElement(s.l,{anchor:c.current,idealDirection:"down",onDismiss:y,size:m,positionRelativeToAnchor:!1},o.a.createElement(s.d,{padding:6,width:m},o.a.createElement(h,{onSelectedDate:e=>{g(e),t(e)},selectedDates:u}))))))}))},VwDf:function(e,t,n){n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));const a=e=>e.toISOString(),o=({currentEventStartDate:e,currentEventEndDate:t,initialEventStartDate:n,initialEventEndDate:o})=>{let r,i;return e&&t?(r=a(e),i=a(t)):t&&(i=a(t)),o&&!t&&(i=""),n&&!e&&(r=""),o&&a(new Date(o))===t&&(i=null),n&&a(new Date(n))===t&&(r=null),{eventEndDate:i,eventStartDate:r}}},WnNx:function(e,t,n){function a(e){return{type:"SHOW_REPIN_ANIMATION",payload:{pinId:e}}}function o(){return{type:"HIDE_REPIN_ANIMATION"}}function r(){return{type:"SHOW_USECASE_FLYOUT"}}function i(){return{type:"HIDE_USECASE_FLYOUT"}}n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return i}))},XKAG:function(e,t,n){var a=n("ut/Y"),o=n("MMmD"),r=n("7GkX");e.exports=function(e){return function(t,n,i){var s=Object(t);if(!o(t)){var c=a(n,3);t=r(t),n=function(e){return c(s[e],e,s)}}var l=e(t,n,i);return l>-1?s[c?t[l]:l]:void 0}}},ZCpW:function(e,t,n){var a=n("lm/5"),o=n("O7RO"),r=n("IOzZ");e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?r(t[0][0],t[0][1]):function(n){return n===e||a(n,e,t)}}},ZE2w:function(e,t,n){n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var a=n("4dcN"),o=n("eOdZ");const r="collaborator_approve_invite";function i(e,t){return o.a.create("BoardEmailInviteResource",{board_id:e,emails:t}).callCreate()}function s(e,t){return o.a.create("BoardInviteResource",{board_id:e,invited_user_ids:t}).callCreate()}function c(e,t){return n=>{return o.a.create("BoardInviteResource",{board_id:e,invited_user_id:t}).callUpdate().then(()=>{a.a.trackEvent(r,"success")}).catch(()=>a.a.trackEvent(r,"error"))}}function l(e,t,n){return t=>{const{invited_user:a,status:r,board:{id:i}}=e;return o.a.create("accepted"===r?"BoardCollaboratorResource":"BoardInviteResource",{ban:n,board_id:i,field_set_key:"boardEdit",invited_user_id:a.id}).callDelete({showError:!1})}}},ZdPf:function(e,t,n){n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i}));const a={CONDITIONAL:0,EMOTIONAL_DISDRESS_OR_SUICIDE:4},o={ABUSIVE:0,SENSITIVE:1,BRAND_UNSAFE:2};function r(e){return null!=e&&(!!e.notice||!!e.notices&&e.notices.length>0)}function i(e){return!!e&&e.severity===o.ABUSIVE}},a49R:function(e,t,n){n.d(t,"a",(function(){return s}));var a=n("q1tI"),o=n.n(a),r=(n("17x9"),n("n6mq"));function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=o.a.createContext(()=>{}),c=752;t.b=class extends a.Component{constructor(...e){super(...e),i(this,"state",{flyout:void 0,showOnTopOfModal:!1}),i(this,"setActive",(e,t,n=!1)=>{if(e){const e={...t,onDismiss:()=>{t&&t.onDismiss&&(t.onDismiss(),this.setState({flyout:void 0}))},positionRelativeToAnchor:!1};this.setState({flyout:{props:e},showOnTopOfModal:n})}else this.setState({flyout:void 0})})}render(){var e,t,n,a,i,l,d,u,h;const{flyout:p,showOnTopOfModal:m}=this.state,{children:g}=this.props;return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.Provider,{value:this.setActive},g),p&&o.a.createElement("div",m?{style:{zIndex:c,position:"absolute",top:0}}:{},o.a.createElement(r.l,{anchor:null===(e=p.props)||void 0===e?void 0:e.anchor,onDismiss:null===(t=p.props)||void 0===t?void 0:t.onDismiss,color:null===(n=p.props)||void 0===n?void 0:n.color,idealDirection:null===(a=p.props)||void 0===a?void 0:a.idealDirection,positionRelativeToAnchor:null===(i=p.props)||void 0===i?void 0:i.positionRelativeToAnchor,shouldFocus:null===(l=p.props)||void 0===l?void 0:l.shouldFocus,showCaret:null===(d=p.props)||void 0===d?void 0:d.showCaret,size:null===(u=p.props)||void 0===u?void 0:u.size},null===(h=p.props)||void 0===h?void 0:h.children)))}}},e0nq:function(e,t,n){function a(e){return{type:"PIN_BETTER_SAVE",payload:e}}function o(e){return{type:"PIN_BETTER_UNSAVE",payload:e}}function r(e){return{type:"PIN_BETTER_SELECT_BOARD_OR_SECTION",payload:e}}function i(e){return{type:"POST_REPIN_MORE_IDEAS_UPSELL_SHOWN",payload:{boardId:e}}}n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i}))},e3KR:function(e,t,n){var a=n("q1tI"),o=n.n(a),r=n("/MKj"),i=(n("7vSn"),n("8cMa")),s=n("n6mq");var c=({isOpen:e,showCollaborativeIcon:t,showPrivateIcon:n,showProtectedIcon:a,showSectionsIcon:r})=>t||n||a||r?o.a.createElement(s.d,{display:"flex",direction:"row",marginEnd:5,dangerouslySetInlineStyle:{__style:{paddingLeft:8}},alignItems:"center"},n&&o.a.createElement(i.a,{type:"secret"}),a&&o.a.createElement(i.a,{type:"protected"}),t&&o.a.createElement(i.a,{type:"group"}),r&&o.a.createElement(i.a,{type:"sections"})):null,l=n("JW66"),d=n("Ye/N"),u=n("4cpq");function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p=52;class m extends a.Component{constructor(...e){super(...e),h(this,"state",{hovered:!1}),h(this,"handleMouseEnter",()=>{this.setState({hovered:!0})}),h(this,"handleMouseLeave",()=>{this.setState({hovered:!1})}),h(this,"handleTouch",()=>{const{board:e,onClick:t}=this.props;t(e)}),h(this,"handleButtonClick",({event:e})=>{const{onButtonClick:t}=this.props;this.handleTouch(),t&&t(),e.stopPropagation()}),h(this,"tapAreaRef",Object(a.createRef)())}focus(){const e=this.tapAreaRef.current;e&&e.focus()}render(){const{hovered:e}=this.state,{board:t,buttonText:n,isSectionOpen:a,shouldOpenSections:r,showFlyoutSaveButton:i}=this.props,h=!!t.section_count&&t.section_count>0,m=h?"boardWithSection":"boardWithoutSection",g=t.image_cover_url;return o.a.createElement(u.a,{id:m},o.a.createElement(s.O,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onTap:this.handleTouch,ref:this.tapAreaRef},o.a.createElement(s.d,{color:e?"lightGray":"white",display:"flex",alignItems:"center",height:p,marginStart:3,marginEnd:3,marginBottom:1,marginTop:1,rounding:3},o.a.createElement(s.d,{flex:"none",marginBottom:1,marginStart:2,marginEnd:3,marginTop:1,overflow:"hidden",width:36,height:36,rounding:2},g&&!r&&o.a.createElement(s.v,{wash:!0,width:36,height:36},o.a.createElement(s.q,{src:g,alt:"",naturalHeight:1,naturalWidth:1,fit:"cover"})),g&&r?o.a.createElement(s.v,{wash:!0,width:36,height:36},o.a.createElement(s.q,{src:g,alt:"",naturalHeight:1,naturalWidth:1,fit:"cover"})):o.a.createElement(s.d,{color:r?"lightGray":"transparent",width:"100%",height:"100%"})),o.a.createElement(s.d,{flex:"grow",paddingY:1,overflow:"hidden",marginStart:1},o.a.createElement(s.P,{truncate:!0,weight:r||!r?"bold":"normal"},t.name)),t&&(!e||e&&h&&!a)?o.a.createElement(s.d,null,o.a.createElement(c,{isOpen:t.isOpen,showCollaborativeIcon:!!t.is_collaborative,showPrivateIcon:t.privacy===l.a.BoardPrivacy.SECRET,showProtectedIcon:t.privacy===l.a.BoardPrivacy.PROTECTED,showSectionsIcon:h&&r})):null,e&&(0===t.section_count||!r)&&i&&o.a.createElement(s.d,{marginEnd:2,flex:"none"},o.a.createElement(s.e,{accessibilityLabel:"save button",color:"red",inline:!0,onClick:this.handleButtonClick,text:n||d.a._("Save","save button","save button")})))))}}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}h(m,"defaultProps",{shouldOpenSections:!0,showFlyoutSaveButton:!0});const f=52,b=53,v=11;class y extends a.Component{constructor(...e){super(...e),g(this,"state",{hovered:!1}),g(this,"handleMouseEnter",()=>{this.setState({hovered:!0})}),g(this,"handleMouseLeave",()=>{this.setState({hovered:!1})}),g(this,"handleTouch",()=>{const{board:e,onClick:t,section:n}=this.props;t(n,e)}),g(this,"handleButtonClick",({event:e})=>{const{onButtonClick:t}=this.props;this.handleTouch(),t&&t(),e.stopPropagation()}),g(this,"tapAreaRef",Object(a.createRef)())}focus(){const e=this.tapAreaRef.current;e&&e.focus()}render(){const{hovered:e}=this.state,{buttonText:t,section:n,showSectionSaveButton:a}=this.props;return o.a.createElement(s.O,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onTap:this.handleTouch,ref:this.tapAreaRef},o.a.createElement(s.d,{color:e?"lightGray":"white",display:"flex",alignItems:"center",height:f,marginTop:1,rounding:3,dangerouslySetInlineStyle:{__style:{marginLeft:b,marginRight:v}}},o.a.createElement(s.d,{flex:"grow",paddingY:1,marginStart:4},o.a.createElement(s.P,{truncate:!0},n.title)),e&&a&&o.a.createElement(s.d,{marginEnd:2,flex:"none"},o.a.createElement(s.e,{accessibilityLabel:"save button",color:"red",inline:!0,text:t||d.a._("Save","save button","save button"),onClick:this.handleButtonClick}))))}}g(y,"defaultProps",{showSectionSaveButton:!0});var S=n("zLLH");var _=Object(S.c)({name:"BoardSectionsRepinResource",key:"sectionsResource",options:e=>({board_id:e.board.id})},{allowStale:!1})(e=>{const{board:t,buttonText:n,sectionsResource:a,onClick:r,onButtonClick:i,showSectionSaveButton:c}=e,l=a&&a.data||[];return o.a.createElement(s.d,null,!a.isLoaded&&o.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:200},o.a.createElement(s.I,{accessibilityLabel:d.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0})),a.isLoaded&&o.a.createElement(s.d,null,l.map(e=>o.a.createElement(y,{board:t,buttonText:n,key:e.id,onButtonClick:i,onClick:r,section:e,showSectionSaveButton:c}))))});function E({isBoardCreate:e,onCreateBoardClick:t}){const[n,r]=Object(a.useState)(!1);return o.a.createElement(s.d,{"data-test-id":"create-board",height:"100%",display:"flex"},o.a.createElement(s.O,{onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onTap:t,rounding:2},o.a.createElement(s.d,{display:"flex",alignItems:"center",color:n?"lightGray":"white",padding:2,width:"100%",height:"100%"},o.a.createElement(s.d,{marginEnd:5,marginStart:4},o.a.createElement(s.o,{accessibilityLabel:"",size:28,icon:"add-circle",color:"red"})),e?o.a.createElement(s.P,{align:"center",truncate:!0,weight:"bold"},d.a._("Create board")):o.a.createElement(s.P,{align:"center",truncate:!0,weight:"bold"},d.a._("Create section")))))}var w=n("nKlH");const I=52;function C({onClick:e,title:t}){const[n,r]=Object(a.useState)(!1);return o.a.createElement(s.O,{onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onTap:()=>{e({title:t})}},o.a.createElement(s.d,{color:n?"lightGray":"white",display:"flex",alignItems:"center",height:I,marginStart:3,marginEnd:3,marginBottom:1,rounding:3},o.a.createElement(s.d,{flex:"none",marginBottom:1,marginStart:2,marginEnd:3,marginTop:1,overflow:"hidden",width:36,height:36,rounding:1},o.a.createElement(s.d,{color:"lightGray",width:"100%",height:"100%"})),o.a.createElement(s.d,{flex:"grow",paddingY:1},o.a.createElement(s.P,{truncate:!0,weight:"bold"},t)),n&&o.a.createElement(s.d,{marginEnd:2},o.a.createElement(s.e,{accessibilityLabel:"create button",color:"red",inline:!0,text:d.a._("Create","create button to create a new board","create button to create a new board")}))))}const B=e=>{const{suggestionsResource:t,onClick:n,pinBuilderSuggestions:a}=e,r=a||t&&t.data||[],i=o.a.createElement(o.a.Fragment,null,r.map((e,t)=>o.a.createElement(C,{key:t,title:e.title,onClick:n})));return o.a.createElement(o.a.Fragment,null,r?i:o.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:200},o.a.createElement(s.I,{accessibilityLabel:d.a._("loading board suggestions","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0})))};var O=n("0BOE"),x=n("eUcp"),R=n("Wer7"),D=n("qyR9"),k=n("U4JR"),P=n("oTtT"),T=n("fArA");function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"c",(function(){return q})),n.d(t,"b",(function(){return W})),n.d(t,"a",(function(){return z}));const L=128.5,A=439,F=52;class M extends a.Component{constructor(...e){super(...e),j(this,"state",{isSectionOpen:null,selectedBoardId:"",selectedBoardCategory:"",searchQuery:"",searchBoxFocused:!0}),j(this,"getItems",()=>{const{boardResource:e,suggestedBoardsShortListResource:t}=this.props;if(!e||!e.data)return[];const{all_boards:n}=e&&e.data,a=n.filter(e=>!this.props.advertiser_id||"secret"!==e.privacy).map(e=>this.mapBoards(e,"allBoards",0)),o=(t&&t.data||[]).map((e,t)=>this.mapBoards(e,"shortlist",t+1)),{searchQuery:r}=this.state;return r.length>=D.a?[...Object(O.a)(a,r)]:[...a.length>3&&o&&o.length?[{type:"header",title:d.a._("Top board suggestions","Header for top suggesions in board picker","Header for top suggesions in board picker")},...o]:[],{type:"header",title:d.a._("All boards","Header for all boards in board picker","Header for all boards in board picker")},...a,...a.length<=3?[{type:"header",title:d.a._("Suggested board names","Header for suggested boards in board picker","Header for suggested boards in board picker")}]:[]]}),j(this,"mapBoards",(e,t,n)=>{const{setBoardWithSection:a}=this.props,{selectedBoardId:o,selectedBoardCategory:r}=this.state,i=e.id===o&&t===r;return i&&a&&a(e),{...e,category:t,isOpen:i,gridIndex:n}}),j(this,"handleBack",()=>{const{setBoardWithSection:e}=this.props;this.setState({isSectionOpen:!1,selectedBoardId:"",selectedBoardCategory:""}),e&&e(null)}),j(this,"handleSectionClick",(e,t)=>{const{onItemChosen:n}=this.props;Object(k.a)(101,{component:13282,element:36,objectId:t.id,view:91,grid_index:t.gridIndex}),n({boardId:t.id,url:e.slug?`${t.url}${e.slug}/`:t.url,sectionId:e.id,title:e.title||"",imageCoverUrl:t.image_cover_url})}),j(this,"handleBoardWithSectionsClick",e=>{const{selectedBoardId:t,selectedBoardCategory:n}=this.state,a=t===e.id&&n===e.category;this.setState({isSectionOpen:!0,selectedBoardId:a?"":e.id,selectedBoardCategory:a?"":e.category})}),j(this,"handleBoardClick",({board:e,toggleSections:t})=>{const{onItemChosen:n}=this.props;this.setState({searchBoxFocused:!1}),t?this.handleBoardWithSectionsClick({id:e.id,category:e.category}):(Object(k.a)(101,{component:13282,element:36,objectId:e.id,view:91,grid_index:e.gridIndex}),n({boardId:e.id,url:e.url,title:e.name||"",imageCoverUrl:e.image_cover_url}))}),j(this,"handleSearchQueryUpdate",e=>{this.setState(t=>({...t,searchQuery:e}))}),j(this,"boardSectionsHeaderRef",Object(a.createRef)())}componentDidMount(){this.props.boardResource&&this.props.boardResource.isLoaded&&this.setPWTLoadingEnd()}componentDidUpdate(e,t){e.boardResource&&!e.boardResource.isLoaded&&this.props.boardResource&&this.props.boardResource.isLoaded&&this.setPWTLoadingEnd(),this.state.isSectionOpen&&!t.isSectionOpen&&this.boardSectionsHeaderRef.current&&this.boardSectionsHeaderRef.current.focus()}setPWTLoadingEnd(){const{boardResource:e,boardPickerStopwatch:t}=this.props;t&&(!e||e.error?t.error():t.stop())}render(){const{boardResource:e,buttonText:t,customItem:n,onBoardCreate:a,onButtonClick:r,paneWidth:i,showCreateBoardButton:c,showFlyoutSaveButton:l,showSections:h,showSectionSaveButton:p,suggestedBoardsShortListResource:g,useStoryboardStyle:f}=this.props,{isSectionOpen:b,searchBoxFocused:v,searchQuery:y}=this.state;if(!e)return null;const{isLoaded:S,data:I,error:C}=e;let O=[];(S&&!C||g&&g.data&&!g.error)&&(O=this.getItems());const R=O.filter(e=>e&&"allBoards"===e.category).length,D=f?200:322,k=f?214:334,P=null===b?"":"BoardsSlideRight",T=S&&I&&I.create_suggestions.map(e=>({title:e}))||[],j=e=>o.a.createElement(o.a.Fragment,null,o.a.createElement(s.k,null),o.a.createElement(s.d,{overflow:"hidden",height:F,dangerouslySetInlineStyle:{__style:{borderBottomRightRadius:8,borderBottomLeftRadius:8}}},o.a.createElement(E,{onCreateBoardClick:()=>a({title:this.state.searchQuery}),isBoardCreate:e})));return o.a.createElement(s.d,{width:"100%",rounding:2,overflow:"hidden",height:f?"100%":A,color:"white",dangerouslySetInlineStyle:{__style:{zIndex:x.b}}},S?null:o.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:i,height:"100%",minHeight:200},o.a.createElement(s.I,{accessibilityLabel:d.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0})),o.a.createElement(s.d,{display:"flex",direction:"row"},S&&o.a.createElement("div",{className:b?"BoardsSlideLeft":P},o.a.createElement(s.d,{position:"relative"},o.a.createElement(s.d,{display:"flex",direction:"row",width:2*i,dangerouslySetInlineStyle:{__style:{zIndex:0}}},o.a.createElement(s.d,{display:"flex",direction:"column",width:i},o.a.createElement(s.d,{padding:3},o.a.createElement(w.a,{accessibilityLabel:d.a._("Search through your boards","search bar placeholder text","search bar placeholder text"),focused:v,id:"pickerSearchField",onChange:({value:e})=>this.handleSearchQueryUpdate(e),placeholder:d.a._("Search","search bar placeholder text","search bar placeholder text"),value:y})),o.a.createElement(s.d,{minHeight:D,maxHeight:D,overflow:"scrollY"},g&&!g.isLoaded?o.a.createElement(u.a,{id:"suggestedBoardsContainer"},o.a.createElement(s.d,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:L},o.a.createElement(s.I,{accessibilityLabel:d.a._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!0}))):null,n,O.map((e,n)=>"header"===e.type?o.a.createElement(s.d,{key:e.title,paddingX:3,paddingY:1,marginTop:n>0?2:1},o.a.createElement(s.P,{size:"md"},e.title)):o.a.createElement(s.d,{key:`${e.category}-${e.id}`},o.a.createElement(m,{board:e,buttonText:t,onClick:e=>{this.handleBoardClick({board:e,toggleSections:h&&!!e.section_count})},onButtonClick:r,shouldOpenSections:h,showFlyoutSaveButton:l}))),R<=3&&o.a.createElement(B,{onClick:a,pinBuilderSuggestions:T})),c&&j(!0)),o.a.createElement(s.d,{display:"flex",direction:"column",width:i},o.a.createElement(s.d,{display:"flex",direction:"row",justifyContent:"center",alignContent:"center",alignItems:"center"},o.a.createElement(s.i,{span:2},o.a.createElement(s.d,{display:"flex",justifyContent:"start",alignContent:"center",alignItems:"center",marginStart:3},o.a.createElement(s.p,{accessibilityLabel:"Back button",icon:"arrow-back",iconColor:"darkGray",onClick:this.handleBack,size:"sm"}))),o.a.createElement(s.i,{span:8},o.a.createElement(s.d,{display:"flex",justifyContent:"center",alignItems:"center",height:52},o.a.createElement(s.P,{weight:"bold"},d.a._("Choose section","Header for section header","Header for section header")))),o.a.createElement(s.i,{span:2},o.a.createElement(s.d,null))),o.a.createElement(s.k,null),o.a.createElement(s.d,{minHeight:k,maxHeight:k,overflow:"scrollY"},O?o.a.createElement(o.a.Fragment,null,O&&O.map((e,n)=>"header"===e.type?null:o.a.createElement(s.d,{key:`${e.category}-${e.id}`},e.isOpen&&o.a.createElement(o.a.Fragment,null,o.a.createElement(m,{board:e,buttonText:t,isSectionOpen:!0,onClick:e=>{this.handleBoardClick({board:e,toggleSections:!1})},onButtonClick:r,shouldOpenSections:!1,showFlyoutSaveButton:l,ref:this.boardSectionsHeaderRef}),o.a.createElement(_,{board:e,buttonText:t,onClick:this.handleSectionClick,onButtonClick:r,showSectionSaveButton:p}))))):null),c&&j(!1)))))))}}function N(e){const t=Object(P.b)();return o.a.createElement(M,Object.assign({},e,{boardPickerStopwatch:t}))}function H(e){const{advertiser:t,viewer:n}=e;if(n&&t){const t=e.advertiser;if(n.isAuth&&t.owner_user_id!==n.id)return{hasMUA:!0,advertiser_id:t.id,username:t.owner_user_id};if(n.isAuth&&t.owner_user_id===n.id)return{hasMUA:!1,advertiser_id:t.id,username:"me"}}return{advertiser_id:void 0,hasMUA:void 0,username:void 0}}function U(e){const{advertiser_id:t,hasMUA:n,username:a}=e;return{field_set_key:"board_picker",filter:n?"protected":"all",...a?{username:a}:{},...t?{advertiser_id:t}:{}}}function q(){return(e,t)=>e(Object(R.f)("BoardPickerBoardsResource",U(H(t()))))}j(M,"defaultProps",{paneWidth:320,showCreateBoardButton:!0,showFlyoutSaveButton:!0,showSections:!0,showSectionSaveButton:!0});const W=Object(T.compose)(Object(r.connect)((function(e){return H(e)})),Object(S.c)({name:"BoardPickerBoardsResource",key:"boardResource",options:U}))(N),z=Object(S.c)({name:"BoardPickerBoardsShortlistResource",key:"suggestedBoardsShortListResource",options:e=>({pin_id:e.pin.id,shortlist_length:3,num_shortlist_suggestions:3})})(N)},eUcp:function(e,t,n){n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"h",(function(){return u}));const a=1,o=2,r=2,i=3,s=1,c=3,l=3,d=4,u=100},fEA9:function(e,t,n){n.r(t);var a=n("q1tI"),o=n.n(a),r=n("/MKj"),i=(n("1vym"),n("qWlA")),s=n("TSYQ"),c=n.n(s),l=n("clxp"),d=n("1inl"),u=n("ajUs"),h=n("Ye/N"),p=n("a49R");class m extends a.Component{constructor(...e){var t,n,a;super(...e),a=()=>{const{setActive:e,showOnTopOfModal:t,...n}=this.props;e("flyout",n,t||!1)},(n="renderFlyout")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a}componentDidMount(){this.renderFlyout()}componentDidUpdate(){this.renderFlyout()}componentWillUnmount(){this.props.setActive()}render(){return null}}const g=e=>a.createElement(p.a.Consumer,null,t=>a.createElement(m,Object.assign({},e,{setActive:t})));g.displayName="MasonryFlyout";var f=g,b=n("3gA6"),v=n("jHGc"),y=n("eOdZ"),S=n("/5zs"),_=n("pLLR"),E=n("lm6u");const w=(e,t)=>{const[n,o]=Object(a.useState)([]),r=Object(_.e)();return Object(a.useEffect)(()=>{let n=!1;if(e){new S.d(r,"web_board_section_templates").enabled()&&y.a.create("SectionRecommendationsResource",{pinIds:[t]}).callGet().then(e=>{var t;if(n)return;const a=null==e?void 0:null===(t=e.resource_response)||void 0===t?void 0:t.data;o(a.length>0&&a[0]||[])})}return()=>{n=!0}},[e,t]),n};function I(e){const{action:t,additionalCreateFields:n,boardWithSection:a,children:r,onClose:i,pin:s,setCompletionPromise:c,showModal:l}=e,d=w(l,s.id);return o.a.createElement(E.a,{additionalCreateFields:n,boardWithSection:a,action:t,hideSuccessAnimation:!!d.length,onClose:i,setCompletionPromise:c,showCreate:!0,shouldShowToast:!d.length,pin:s},e=>r({...e,sectionSuggestions:d}))}var C=n("e3KR"),B=n("Wrea"),O=n("fArA"),x=n("0zyx"),R=n("TN0d"),D=n("vvax"),k=n("EuRG"),P=n("H/Lk"),T=n("WnNx"),j=n("U4JR"),L=n("NjDU"),A=n("CvCA"),F=n("e0nq");const M=5e3,N=16,H=({boardId:e,boardUrl:t,postRepinMoreIdeasUpsell:n})=>{if(!t)return!1;const{recentSaves:a,recentUpsell:o}=n;if(o[e])return!1;const r=a.findIndex(t=>t.boardId!==e);return(-1===r?a.length:r)+1>=3};var U=Object(r.connect)(null,(e,t)=>({toastShown:()=>e(Object(F.c)(t.boardId))}))(class extends a.PureComponent{constructor(...e){var t,n,a;super(...e),a=()=>{const{boardId:e}=this.props;Object(j.a)(101,{component:20,element:10805,objectId:e})},(n="handleClick")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a}componentDidMount(){const{toastShown:e}=this.props;e()}render(){const{boardName:e,boardUrl:t,onHide:n}=this.props;return a.createElement(A.a,{duration:M,onHide:n,text:Object(D.b)(h.a._("Find more ideas for {{ boardName }}"),{boardName:e}).join(""),href:`${t}more_ideas/?ideas_referrer=${N}`,onClick:this.handleClick})}}),q=n("zLLH"),W=n("C0mq"),z=n("ZdPf"),G=n("B6Tf"),V=n("oTtT"),Y=n("nGHF"),K=n("n6mq"),Z=n("0nTG");function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"PinBetterSave",(function(){return ee}));const $={CLASSIC:40,LEGO:44},X=4;function J({savedInfo:e,variant:t}){const n="lego-closeup"===t,a=n?"sm":"md";return o.a.createElement(b.b,{className:"underlineLink",stopPropagation:!0,style:{color:"#333"},to:e.url||""},o.a.createElement(K.d,{marginStart:n?1:0},o.a.createElement(K.P,{color:"darkGray",inline:!0,size:a},Object(D.b)(h.a._("Saved to {{ destination }}","Saved to label for better save","Saved to label for better save"),{destination:o.a.createElement(K.P,{color:"darkGray",key:"pin_auto_save_link",size:a,truncate:!0,weight:"bold"},e.title)}))))}class ee extends o.a.Component{constructor(...e){var t;super(...e),t=this,Q(this,"state",{boardWithSection:null,buttonRef:null,createdBoard:null,suggestedBoardTitle:"",showBoardFlyout:!1,showRepinModal:!1,sensitiveContentNotice:null}),Q(this,"saveButtonRef",e=>{this.setState({buttonRef:e})}),Q(this,"setBoardSaveCompletionPromise",e=>{const{createdBoard:t}=this.state;this._repinCompletionPromise=e,this._repinCompletionPromise.promise.then(e=>{if(!e.board)return;const{board:{id:n,name:a,url:o}}=e,r={boardId:n,title:a,url:o};this.updateSelectedBoardOrSection(r),this.updateSavedState({...r,localPinId:e.id}),t&&Object(z.d)(t.sensitivity)&&Object(z.c)(t.sensitivity)?this.setState({sensitiveContentNotice:t.sensitivity.notice||t.sensitivity.notices[0]}):this.handleRepinHide()})}),Q(this,"updateSavedState",e=>{const{reduxLocation:t,save:n,searchQueryInvalidated:a,onSave:o,pin:{id:r}}=this.props,i=t.query&&t.query.q||Object(x.a)(t.history);n({pinId:r,...e}),i&&a(i),o&&o()}),Q(this,"updateSelectedBoardOrSection",e=>{const{selectBoardOrSection:t,pin:{id:n}}=this.props;t({pinId:n,...e})}),Q(this,"updateSelectedItem",()=>{const{initialSelection:e,selectedItem:t}=this.props;!t&&e&&this.updateSelectedBoardOrSection(e)}),Q(this,"dropdownRef",o.a.createRef()),Q(this,"handleItemChosen",e=>{this.updateSelectedBoardOrSection(e),this.hideFlyout(!0),this.save(e)}),Q(this,"handleBoardCreate",Object(i.a)(({title:e=""}={})=>{this.hideFlyout(!0),this.setState(t=>({...t,suggestedBoardTitle:e,showRepinModal:!0}));const{onToggleFlyout:t}=this.props;t&&t(!0,!0)})),Q(this,"handleBoardCreated",e=>{this.setState({createdBoard:e})}),Q(this,"handleRepinHide",()=>{this.setState(e=>({...e,suggestedBoardTitle:"",showRepinModal:!1}));const{onToggleFlyout:e}=this.props;e&&e(!1,!1)}),Q(this,"handleBoardDropdownClick",e=>{const{pin:{id:t},viewParameter:n,boardPickerStopwatch:a}=this.props;e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),this.state.showBoardFlyout?this.hideFlyout(!0):(Object(j.a)(101,{component:13282,element:10960,viewParameter:n,objectId:t}),a&&a.start(),this.showFlyout())}),Q(this,"handleSaveClick",(async function(e){const{selectedItem:n}=t.props;n?(e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),Object(j.a)(101,{component:13282,element:36,objectId:n.boardId,grid_index:X}),await t.save(n)):t.handleBoardDropdownClick(e)})),Q(this,"setBoardWithSection",e=>{this.setState({boardWithSection:e})}),Q(this,"handleEditSubmit",({boardId:e,sectionId:t,url:n,title:a})=>{const{pin:{id:o},savedInfo:{localPinId:r}={}}=this.props;this.updateSavedState({pinId:o,localPinId:r,boardId:e,sectionId:t||"",url:n,title:a})}),Q(this,"resetPinSavedState",()=>{this.updateSavedState({boardId:"",localPinId:"",sectionId:"",title:"",url:""})}),Q(this,"deleteSavedState",()=>{const{unsave:e,onDelete:t,pin:{id:n}}=this.props;e({pinId:n}),t&&t()}),Q(this,"save",(async function(e){const{isLimitedLogin:n,mostRecentBoard:a,pin:{id:r},postRepinMoreIdeasUpsell:i,postRepinUpsellDisabled:s,save:c,setMostRecentBoard:l,showRepinAnimation:u,toastManagerContext:h}=t.props;t.updateSavedState(e);try{const{resource_response:{data:n}}=await t.getPinResource(e).callCreate({showError:!1}),d=e.url,{incrementBoardPinCount:p,updateUserPinCount:m,viewerUserId:g}=t.props;!s&&d&&H({boardId:e.boardId,boardUrl:d,postRepinMoreIdeasUpsell:i})&&h.showToast(({onHide:t})=>o.a.createElement(U,{boardId:e.boardId,boardName:e.title,boardUrl:d,onHide:t})),c({pinId:r,...e,localPinId:n.id}),R.b.publish("currentUser","pinCreated",n),R.b.publish(n.board.id,"pinCreated",{pin:n}),p({boardId:e.boardId,sectionId:e.sectionId}),m(g),u(r),a&&e.boardId!==a.id&&l(e.boardId,e.title,e.url)}catch(p){n||d.a.showError(p.message_detail||p.message),t.resetPinSavedState()}})),Q(this,"hideFlyout",(e=!1)=>{const{onToggleFlyout:t}=this.props;this.setState({showBoardFlyout:!1}),t&&t(!1,e)})}componentDidMount(){const{onMount:e}=this.props;this.updateSelectedItem(),e&&e()}componentDidUpdate(e,t){this.updateSelectedItem()}getPinResource(e){const{carousel_data:t,location:n,previousHistory:a,pin:o}=this.props,r=t&&t.index,i=Object(u.a)(o,n,a)||`${o.tracking_params}~0`,s={description:o.description||"",link:o.link,title:o.title||"",clientTrackingParams:i,board_id:e.boardId||"",pin_id:o.id||"",image_base64:o.image_base64,is_buyable_pin:!1,is_removable:o.promoted_is_removable,carousel_slot_index:r||0,...e.sectionId?{section:e.sectionId}:{},...Object(Z.a)(o)||{}};return y.a.create("RepinResource",s)}showFlyout(){const{onToggleFlyout:e}=this.props;this.setState({showBoardFlyout:!0}),e&&e(!0,!0)}render(){const{boardResource:e,useMasonryFlyout:t,onToggleModal:n,pin:a,requestContext:r,renderSavedStatus:i,renderPinSaveTooltip:s,selectedItem:d,savedInfo:u,unselectedText:p,variant:m,viewParameter:g}=this.props,{boardWithSection:b,buttonRef:y,showBoardFlyout:S,showRepinModal:_,sensitiveContentNotice:E,suggestedBoardTitle:w}=this.state,B=t?f:K.l,{carousel_data:O}=a,x="lego-closeup"===m||"lego-pin"===m,R=x?"sm":"md";let D={};"lego-closeup"===m?D={bgColor:"transparent",iconColor:"darkGray",size:"sm"}:"lego-pin"===m?D={bgColor:"white",iconColor:"darkGray",size:"sm"}:"pin"===m&&(D={bgColor:"transparentDarkGray",iconColor:"white",size:"sm"});const k=i&&u&&i({savedInfo:u,variant:m}),P=o.a.createElement(C.a,{boardResource:e,setBoardWithSection:this.setBoardWithSection,onItemChosen:this.handleItemChosen,onBoardCreate:this.handleBoardCreate,pin:a});return o.a.createElement(l.a,{name:"PinBetterSave"},o.a.createElement(K.d,{width:"100%",display:"lego-closeup"===m?"flex":void 0,height:"lego-closeup"===m?$.LEGO:void 0,color:"lego-closeup"===m?"lightGray":void 0,rounding:"lego-closeup"===m?4:void 0},(null==u?void 0:u.title)?o.a.createElement(K.d,{display:"flex",direction:"row",alignItems:"center",width:"lego-closeup"===m?"100%":void 0,paddingX:"lego-closeup"===m?2:void 0,marginStart:"lego-pin"===m?-1:void 0,marginEnd:"lego-pin"===m?-1:void 0},k&&o.a.createElement(K.d,{paddingX:1,"data-test-id":"saved-info",flex:"grow"},k),o.a.createElement(K.d,{paddingX:1,flex:"none",marginStart:"auto"},o.a.createElement(v.default,{component:0,onDelete:this.deleteSavedState,onSubmit:this.handleEditSubmit,pinId:u.localPinId,onToggleModal:n,viewParameter:g,carouselSlotCurrentIndex:O&&O.index,style:D,useLegoStyles:"lego-pin"===m}))):o.a.createElement(K.d,{alignItems:"center",display:"flex",width:"100%",height:x?$.LEGO:$.CLASSIC},o.a.createElement("button",{className:c()("PinBetterSave__Dropdown",{"PinBetterSave__Dropdown--rtl":r.isRTL,"PinBetterSave__Dropdown--lego":x,"PinBetterSave__Dropdown--lego-pin":"lego-pin"===m,"PinBetterSave__Dropdown--lego-closeup":"lego-closeup"===m,"PinBetterSave__Dropdown--expanded":S&&!x,"PinBetterSave__Dropdown--expandedLego":S&&x}),"data-test-id":"PinBetterSaveDropdown",onClick:this.handleBoardDropdownClick,ref:this.dropdownRef},o.a.createElement(K.d,{paddingX:4,display:"flex",flex:"grow",alignItems:"center"},o.a.createElement(K.d,{flex:"grow",minWidth:0,overflow:"hidden"},d&&d.title?o.a.createElement(K.P,{truncate:!0,size:R},o.a.createElement("span",{className:c()("PinBetterSave__DropdownText",{"PinBetterSave__DropdownText--lego":x})},d.title)):o.a.createElement(K.P,{color:"gray",truncate:!0,size:R},o.a.createElement("span",{className:c()("PinBetterSave__DropdownText",{"PinBetterSave__DropdownText--lego":x})},p))),o.a.createElement(K.d,{marginStart:2,flex:"none","data-test-id":"boardSelectionDropdown"},o.a.createElement("div",{className:c()("PinBetterSave__DownArrowContainer",{"PinBetterSave__DownArrowContainer--lego":x})},o.a.createElement(K.o,{accessibilityLabel:h.a._("Select a board you want to save to","BetterSave accessibility label to change the board","BetterSave accessibility label to change the board"),color:"darkGray",icon:"arrow-down",size:12}))))),!S&&o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{className:c()("PinBetterSave__Button",{"PinBetterSave__Button--rtl":r.isRTL,"PinBetterSave__Button--lego":x,"PinBetterSave__Button--lego-pin":"lego-pin"===m}),onClick:this.handleSaveClick,"data-test-id":"PinBetterSaveButton",ref:this.saveButtonRef},o.a.createElement(K.P,{color:"white",size:R,weight:"bold"},h.a._("Save","BetterSave Save label","BetterSave Save label"))),!!s&&!!y&&s(y))),o.a.createElement(I,{additionalCreateFields:{is_stl_pin:Object(Z.f)(a)},boardWithSection:b,action:"create",onClose:this.handleRepinHide,setCompletionPromise:this.setBoardSaveCompletionPromise,showModal:_,pin:a},({boardSavedTo:e,dismissModal:t,displaySuccessAnimation:n,handleAbort:a,handleNewBoardAnimationCompletion:r,handleSocialConnectSet:i,handleSaveToBoard:s,newPin:c,updateDescription:l,modalTitle:d,sectionSuggestions:u,setModalTitle:h,pin:p})=>o.a.createElement(G.b,{boardSavedTo:e,isInModal:!0,displaySuccessAnimation:n,dismissModal:t,handleAbort:a,handleNewBoardAnimationCompletion:r,handleSocialConnectSet:i,handleSaveToBoard:s,updateDescription:l,onBoardCreated:this.handleBoardCreated,sensitiveContentNotice:E,pin:p,pwtAuxData:{pin_create_method:"repin"},sectionSuggestions:u,suggestedBoardTitle:w,boardWithSection:b,shouldRenderContent:_,newPin:c,modalTitle:d,setModalTitle:h,showCreate:!0})),S&&"lego-closeup"===m&&o.a.createElement(K.l,{anchor:this.dropdownRef.current,idealDirection:"down",onDismiss:this.hideFlyout,size:"lg"},P),S&&"lego-closeup"!==m&&o.a.createElement(B,{anchor:this.dropdownRef.current,idealDirection:"down",onDismiss:this.hideFlyout,positionRelativeToAnchor:!t,size:"lg"},P)))}}Q(ee,"defaultProps",{variant:"pin",renderSavedStatus:({savedInfo:e,variant:t})=>o.a.createElement(J,{savedInfo:e,variant:t})});t.default=o.a.memo(Object(O.compose)(_.f,Object(r.connect)(({location:e,history:t,mostRecentBoard:n,pins:a,ui:o,viewer:r},{pin:{id:i}})=>{const s=a[i],{postRepinMoreIdeasUpsell:c}=o;return{carousel_data:s&&s.carousel_data,previousHistory:t.previous,isLimitedLogin:r.isLimitedLogin,savedInfo:s&&s.savedInfo,selectedItem:s&&s.selectedItem,reduxLocation:e,postRepinMoreIdeasUpsell:c,mostRecentBoard:n,viewerUserId:r.id}},e=>({incrementBoardPinCount:({boardId:t,sectionId:n})=>e(Object(B.d)({boardId:t,sectionId:n,increment:1})),save:t=>e(Object(F.a)(t)),unsave:t=>e(Object(F.d)(t)),selectBoardOrSection:t=>e(Object(F.b)(t)),setMostRecentBoard:(t,n,a)=>e(Object(P.a)(t,n,a)),searchQueryInvalidated:t=>e(Object(k.b)(t)),showRepinAnimation:t=>e(Object(T.c)(t)),updateUserPinCount:t=>e(Object(L.b)({userId:t,increment:1}))})),Y.c,Object(q.c)({name:"BoardPickerBoardsResource",key:"boardResource",options:()=>({field_set_key:"board_picker"})}),Object(q.c)({name:"BoardPickerBoardsShortlistResource",key:"suggestedBoardsShortListResource",options:e=>({pin_id:e.pin.id,shortlist_length:2,num_shortlist_suggestions:2,suggestions_only:!0,min_confidence:.5})}),W.a)((function(e){const{suggestedBoardsShortListResource:t,initialSelection:n,mostRecentBoard:a}=e,r=Object(V.b)();if(n)return o.a.createElement(ee,Object.assign({},e,{boardPickerStopwatch:r,postRepinUpsellDisabled:!0,unselectedText:n.title}));const i=t&&t.data&&t.data[0];return o.a.createElement(K.d,{overflow:"hidden"},o.a.createElement(ee,Object.assign({},e,{boardPickerStopwatch:r,initialSelection:t&&t.isLoaded&&i&&{boardId:i.id,title:i.name,url:i.url}||t&&t.isLoaded&&!i&&a&&{boardId:a.id,title:a.name,url:a.url}||void 0,unselectedText:t&&t.isLoaded?h.a._("Select","BetterSave label to pick a board from the list","BetterSave label to pick a board from the list"):"..."})))})))},jZhD:function(e,t,n){n.d(t,"a",(function(){return i}));var a=n("q1tI"),o=(n("17x9"),n("pdBG"));function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class i extends a.Component{constructor(...e){super(...e),r(this,"searchCache",Object.create(null)),r(this,"lastSearchedQuery",null),r(this,"search",e=>{this.lastSearchedQuery=e,e in this.searchCache?this.props.onTypeaheadSuggestionsChange(this.searchCache[e],e):this.provider.search(e,({items:t})=>{this.searchCache[e]=t,e===this.lastSearchedQuery&&this.props.onTypeaheadSuggestionsChange(t,e)})})}componentDidMount(){const e=this.props.resourceOptions||{};this.provider=new o.a({resource_name:this.props.resourceName,...e});const{value:t}=this.props;null!=t&&this.props.allowSearchOnMount&&this.search(this.props.value)}UNSAFE_componentWillReceiveProps({value:e}){null!=e&&e!==this.props.value&&this.search(e)}render(){return this.props.children||null}}r(i,"defaultProps",{resourceName:"TypeaheadResource"})},"lm/5":function(e,t,n){var a=n("fmRc"),o=n("wF/u"),r=1,i=2;e.exports=function(e,t,n,s){var c=n.length,l=c,d=!s;if(null==e)return!l;for(e=Object(e);c--;){var u=n[c];if(d&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++c<l;){var h=(u=n[c])[0],p=e[h],m=u[1];if(d&&u[2]){if(void 0===p&&!(h in e))return!1}else{var g=new a;if(s)var f=s(p,m,h,e,t,g);if(!(void 0===f?o(m,p,r|i,s,g):f))return!1}}return!0}},"mVx/":function(e,t,n){var a=n("XKAG")(n("JELi"));e.exports=a},nKlH:function(e,t,n){n.d(t,"a",(function(){return i}));var a=n("q1tI"),o=n.n(a),r=n("n6mq");function i(e){const{accessibilityLabel:t,focused:n,id:i,onBlur:s,onChange:c,onFocus:l,placeholder:d,value:u}=e,h=Object(a.useRef)(null);return Object(a.useEffect)(()=>{if(n){const e=h.current;window.requestAnimationFrame(()=>{const t=e&&e.querySelector("input");t instanceof HTMLInputElement&&t.focus()})}},[n]),o.a.createElement(r.d,{ref:h},o.a.createElement(r.F,{accessibilityLabel:t,id:i,onBlur:s,onChange:c,onFocus:l,placeholder:d,size:"lg",value:u}))}},ou9u:function(e,t,n){function a(e){const t=e.videos&&e.videos.video_list&&Object.keys(e.videos.video_list).length>0?e.videos.video_list:null;return t?t.V_HLSV3_MOBILE||t.V_HLSV4||t.V_720P:null}n.d(t,"a",(function(){return a}))},pdBG:function(e,t,n){var a=n("AHhP"),o=n.n(a);const r=function(e,t){this.uid=e,this.item=t,this.next=null,this.prev=null},i=function(e){this._maxNumItems=e||10,this._uidToData={},this._numItems=0,this._firstData=null,this._lastData=null};i.prototype.set=function(e,t){let n=this._uidToData[e];n||(n=new r(e,t),this._uidToData[e]=n,this._numItems+=1),this._moveToFront(n),this._numItems>this._maxNumItems&&this._evict()},i.prototype.get=function(e){const t=this._uidToData[e];return t?(this._moveToFront(t),t.item):null},i.prototype.remove=function(e){const t=this._uidToData[e];t&&(delete this._uidToData[e],this._firstData===t&&(this._firstData=t.next),this._lastData===t&&(this._lastData=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this._numItems-=1)},i.prototype._moveToFront=function(e){this._firstData!==e&&(this._firstData?(this._lastData===e&&(this._lastData=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this._firstData.prev=e,e.next=this._firstData,e.prev=null,this._firstData=e):(this._firstData=e,this._lastData=e))},i.prototype._evict=function(){delete this._uidToData[this._lastData.uid],this._firstData===this._lastData?(this._firstData=null,this._lastData=null):(this._lastData=this._lastData.prev,this._lastData.next=null),this._numItems-=1};var s=i,c=n("eOdZ"),l=n("mBfy");const d=function(e){e=e||{},this.tags=e.tags,this.enable_recent_queries=!!e.enable_recent_queries,this.minimum_term_character_length=e.minimum_term_character_length||0,this.bypass_lru_cache=e.bypass_lru_cache;const t={tags:e.tags,pin:e.pin_id},n=e.num_places;n?t.num_places=n:t.count="count"in e?e.count:5,e.exclude_non_followers&&(t.exclude_non_followers=!0),e.field_set_key&&(t.field_set_key=e.field_set_key),e.pin_scope&&(t.pin_scope=e.pin_scope),e.suggestion_type&&(t.suggestion_type=e.suggestion_type);let a="TypeaheadResource";e.resource_name&&(a=e.resource_name),this.searchResource=c.a.create(a,t),this.itemsCache=new s};Object.assign(d.prototype,o.a),Object.assign(d.prototype,{search(e,t){let n;if(!e&&"pinners_and_contacts"===this.tags)return this.abortSearch(),this.publishData(e,[],{},t);if(!e&&l.default.isLimitedLogin())return this.abortSearch(),this.publishData(e,[],{},t);if(!e&&this.enable_recent_queries&&l.default&&l.default.isAuthenticated())n="recent_search";else{const n=this.bypass_lru_cache?{}:this.itemsCache.get(e);if(n){const a=n.items;if(a&&a.length){this.abortSearch();const o=n.hint;return void this.publishData(e,a,o,t)}}}e.length>=this.minimum_term_character_length?this.fetch(e,n,t):this.publishData(e,[],{},t)},getResource(){return this.searchResource},abortSearch(){this.getResource().abort()},publishData(e,t,n,a){const o={term:e,items:t,hint:n};this.trigger("data",o),a&&a(o)},setAutocompleteScope(e){this.getResource().set("autocompleteScope",e)},fetch(e,t,n){const a=this.getResource();if(a.isCalling()){const t=a.get("term");if(e===t)return;this.abortSearch()}""!==this.tags&&(a.set("term",e),a.set("tags",t||this.tags),a.resetBookmark(),a.callGet({showError:!1}).then(t=>{const a=t.resource_response.data,o=a.items,r=a.hint||{},i={hint:r,items:o};this.cacheData(e,i),this.publishData(e,o,r,n)},e=>{this.trigger("fetchError",e)}),this.warm=!0)},removeCacheForTerm(e){this.itemsCache.remove(e)},cacheData(e,t){this.itemsCache.set(e,t)},prefetch(){if(this.warm)return;c.a.create("TypeaheadPrepareResource").callGet({showError:!1}),this.warm=!0}});t.a=d},"ut/Y":function(e,t,n){var a=n("ZCpW"),o=n("GDhZ"),r=n("zZ0H"),i=n("Z0cm"),s=n("+c4W");e.exports=function(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?i(e)?o(e[0],e[1]):a(e):s(e)}},"w/op":function(e,t,n){},w70y:function(e,t,n){n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n("q1tI"),o=n.n(a),r=n("/MKj"),i=n("lSCD"),s=n.n(i),c=n("aK+E"),l=n("zLLH"),d=n("y19s"),u=n("Wer7");const h={};function p({acceptPrefetch:e,allowStale:t,enabledRouteRefresh:n,dangerouslyDisableFetch:o,options:i,name:s,headers:p}){const m=Object(r.useDispatch)(),g=Object(c.a)(i),f=Object(a.useRef)(),b=e=>(e[s]||h)[g]||h,{isPrefetch:v,nextBookmark:y,prefetchHasBeenRead:S}=Object(r.useSelector)(({resources:e})=>b(e.data)),_=Object(r.useSelector)(({resources:e})=>b(e.data).data),E=Object(r.useSelector)(({resources:e})=>b(e.data).error),w=Object(r.useSelector)(({resources:e})=>Boolean((e.fetching[s]||h)[g])),I=Object(r.useSelector)(({resources:e})=>Boolean((e.data[s]||h)[g])),{history:C}=Object(d.b)(),B=C&&"POP"!==C.action,O=Boolean(I&&n&&B&&!o),[x,R]=Object(a.useState)(O);void 0===f.current&&I&&B&&e&&v&&!S&&!o&&m(Object(u.h)(s,i));const D=Object(a.useCallback)(()=>{o||m(Object(u.a)(s,i,p))},[o,m,p,s,g]),k=Object(a.useCallback)(()=>{o||m(Object(u.d)(s,i,p))},[o,p,s,g]),P=Object(a.useCallback)(()=>{o||(D(),R(!0))},[o,D,R]),T=Object(a.useRef)({data:void 0,error:void 0,fetchMore:k,isAtEnd:!1,isFetching:!1,isLoaded:!1,isPrefetch:void 0,isRefreshing:!1,nextBookmark:void 0,prefetchHasBeenRead:void 0,refreshData:P});Object(a.useEffect)(()=>{!1!==t&&I&&!O||D()},[]),Object(a.useEffect)(()=>{void 0!==f.current&&g!==f.current&&D(),f.current=g},[g]);const j={data:_,error:E,fetchMore:k,isAtEnd:I&&!w&&y===l.a,isFetching:w,isLoaded:I,isPrefetch:v,isRefreshing:x,nextBookmark:y,prefetchHasBeenRead:S,refreshData:P};return Object(r.shallowEqual)(j,T.current)||(!x||O||Object(r.shallowEqual)(j.data,T.current.data)||(j.isRefreshing=!1,R(!1)),T.current=j),T.current}function m(e){const t=e.key;return function(n){function a(a){const{dangerouslyDisableFetch:r,options:i,key:c,...l}=e,d=p({...l,options:(s()(i)?i(a):i)||{},dangerouslyDisableFetch:!!r&&r(a)}),u={[t]:d};return o.a.createElement(n,Object.assign({},a,u))}return a.displayName=`withResourceExperimental[${e.name}](${n.displayName||n.name||""})`,a.WrappedComponent=n,a}}},yKES:function(e,t,n){n.d(t,"a",(function(){return l}));var a=n("q1tI"),o=n.n(a),r=n("Ye/N"),i=n("US8k"),s=n("n6mq");const c=24;function l({duration:e}){return o.a.createElement(s.d,{alignItems:"center",color:"transparentDarkGray",display:"flex",height:c,justifyContent:"center",paddingX:2,rounding:"pill"},o.a.createElement(s.o,{accessibilityLabel:r.a._("Video camera icon","Video camera indicator icon for a Pin","Video camera indicator icon for a Pin"),color:"white",icon:"video-camera"}),o.a.createElement(s.d,{marginStart:1},o.a.createElement(s.P,{color:"white",size:"sm",truncate:!0},Object(i.a)(e))))}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/js/PinBetterSaveCommon-a0dd184c7b52b007799b.mjs.map
